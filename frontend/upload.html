<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RAGBOT Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  
  <style>
    /* Chat bubbles */
    .bubble-user {
      background-color: #d1e7dd; 
      padding: 10px 14px;
      border-radius: 16px;
      max-width: 100vh;
      margin-left: auto;
      margin-bottom: 10px;
      word-wrap: break-word;
    }
    .bubble-bot {
      background-color: #f8d7da; 
      padding: 10px 14px;
      border-radius: 16px;
      max-width: 100vh;
      margin-right: auto;
      margin-bottom: 10px;
      word-wrap: break-word;
    }

    /* Chat area */
    #answerBox {
      max-height: 100%;
      overflow-y: auto;
      background-color: #f9f9f9;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }

    /* Sidebar */
    .sidebar {
      background: #fff;
      border-right: 1px solid #dee2e6;
      height: 100%;
    }
    .sidebar h5, .sidebar h6 {
      color: #333;
    }
    .file-item {
      padding: 6px 8px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .file-item:hover {
      background-color: #f1f1f1;
    }

    /* File viewer */
    #fileViewer {
      background: #fff;
      border: 1px solid #dee2e6;
      border-radius: 8px;
      padding: 1rem;
    }

    /* Chat input */
    .chat-input .form-control {
      border-radius: 2rem;
    }
    .chat-input .btn {
      border-radius: 50%;
    }

    /* Header */
    header.navbar {
      background: #343a40 !important;
    }
    header .navbar-brand {
      font-weight: bold;
      color: #fff !important;
    }

    /* Footer */
    footer {
      font-size: 14px;
      border-top: 1px solid #dee2e6;
      background: #fff;
    }
    footer a {
      color: #0d6efd;
      text-decoration: none;
    }
    footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body class="d-flex flex-column min-vh-100">

  <!-- HEADER -->
  <header class="navbar navbar-dark px-3">
    <a class="navbar-brand" href="#">ðŸ¤– RAGBOT</a>
    <div>
      <a href="index.html" class="text-white me-3">Home</a>
      <a href="pricing.html" class="text-white me-3">Pricing</a>
      <a href="blog.html" class="text-white me-3">Blog</a>
      <button class="btn btn-outline-light btn-sm" onclick="logout()">Logout</button>
    </div>
  </header>

  <!-- MAIN -->
  <div class="container-fluid flex-grow-1">
    <div class="row" style="height: calc(100vh - 80px);">

      <!-- SIDEBAR -->
      <div class="col-2 sidebar p-0">
        <!-- Logo -->
        <div class="p-3 border-bottom">
          <h5 class="m-0">ðŸ“‚ Files</h5>
        </div>

        <!-- Upload -->
        <div class="p-3 border-bottom">
          <label for="fileInput" class="form-label fw-bold">Upload a File</label>
          <input type="file" id="fileInput" class="form-control mb-2" />
          <button onclick="uploadFile()" class="btn btn-primary w-100">
            <i class="fas fa-upload"></i> Upload
          </button>
        </div>

        <!-- File list -->
          <div class="p-3 border-bottom">
          <h6 class="fw-bold mb-2">
            <i class="fas fa-folder-open"></i> My Files
          </h6>
          <ul id="fileList" class="list-unstyled overflow-auto" style="max-height:55vh;">
            <li class="file-item">ðŸ“„ File1.pdf</li>
            <li class="file-item">ðŸ“„ File2.docx</li>
            <li class="file-item">ðŸ“„ File3.txt</li>
          </ul>
        </div>
      </div>

      <!-- CENTER -->
      <div class="col-7 d-flex flex-column h-100 p-4">
        <h5 class="mb-3">ðŸ“‘ Document Viewer</h5>
        <div id="fileViewer" class="flex-grow-1 overflow-auto">
          <p>Select a file to preview its content here.</p>
        </div>
      </div>

      <!-- CHAT -->
      <div class="col-3 border-start d-flex flex-column h-100 p-0">
        <!-- Chat Section Title -->
       <div class="p-2 border-bottom light">
       <h5 class="m-3">ðŸ’¬ Chat</h5>
       </div>

        <!-- Chat header -->
        <div class="bg-primary text-white p-2">
          <h6 id="selectedFileName" class="m-0">Chat with RAGBOT</h6>
        </div>

        <!-- Chat history -->
        <div id="answerBox" class="flex-grow-1 p-3 overflow-auto"></div>

        <!-- Input -->
        <div class="p-2 border-top bg-white chat-input">
          <div class="input-group">
            <input type="text" id="questionInput" class="form-control" placeholder="Type your question...">
            <button id="askButton" onclick="askQuestion()" class="btn btn-success ms-2">â†‘</button>
          </div>
          <div id="loadingSpinner" style="display: none; margin-top: 5px;">
            <small>Bot is thinking<span id="dots">.</span></small>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- FOOTER -->
  <footer class="text-center text-muted py-2 mt-auto">
    Â© 2025 RAGBOT | <a href="#">Privacy</a> | <a href="#">Contact</a>
  </footer>

  <!-- JS -->
  <script>
    let dotCount = 1;
    setInterval(() => {
      const dots = document.getElementById("dots");
      if (!dots) return;
      dotCount = (dotCount % 3) + 1;
      dots.innerText = ".".repeat(dotCount);
    }, 500);

    function logout() {
      localStorage.removeItem("token");
      localStorage.removeItem("user_id");
      window.location.href = "/static/auth.html";
    }

    function uploadFile() {
      const fileInput = document.getElementById("fileInput");
      if (fileInput.files.length > 0) {
        alert("File uploaded: " + fileInput.files[0].name);
      } else {
        alert("Please select a file first!");
      }
    }
  </script>
  <script src="/static/js/upload.js"></script>
</body>
</html>
